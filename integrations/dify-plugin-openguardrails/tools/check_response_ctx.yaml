identity:
  name: "check_response_ctx"
  author: "openguardrails"
  label:
    en_US: "OGR Check Response Contextual"
description:
  human:
    en_US: "Contextually detect AI response data leakage and content safety based on standards"
  llm: "Use this tool to analyze AI-generated responses for content safety violations, data leakage, malicious operations and off topic, considering the original prompt context. Essential for ensuring AI responses are safe, appropriate, and comply with content policies."
parameters:
  - name: prompt
    type: string
    required: true
    label:
      en_US: "Original Prompt"
    human_description:
      en_US: "The original user prompt that generated the response"
    llm_description: "The original prompt from user that was used to generate the response, providing context for analysis"
    form: llm
  - name: response
    type: string
    required: true
    label:
      en_US: "AI Response"
    human_description:
      en_US: "The AI-generated response content to be analyzed contextual for safety"
    llm_description: "The AI-generated response content that needs to be checked for content safety, value compliance, and potential harmful content"
    form: llm
  - name: user_id
    type: string
    required: false
    label:
      en_US: "User ID"
    human_description:
      en_US: "The user ID to be used for risk control"
    llm_description: "The user ID to be used for risk control"
    form: llm
output_schema:
  type: object
  properties:
    id:
      type: string
      description: "Unique identifier for the guardrails check"
    overall_risk_level:
      type: string
      description: "Overall risk level: no_risk, low_risk, medium_risk, high_risk"
    suggest_action:
      type: string
      description: "Suggested action: pass, reject, replace"
    suggest_answer:
      type: string
      description: "Suggested alternative answer if action is replace, empty string if not applicable"
    categories:
      type: string
      description: "Risk categories, separated by commas"
    score:
      type: number
      description: "Detection probability score (0.0-1.0)"
extra:
  python:
    source: tools/check_response_ctx.py
