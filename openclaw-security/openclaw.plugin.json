{
  "id": "openguardrails",
  "name": "OpenGuardrails",
  "description": "Local prompt sanitization and prompt injection detection.",
  "version": "6.0.3",
  "configSchema": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "enabled": {
        "type": "boolean",
        "description": "Enable or disable the guard (default: true)"
      },
      "gatewayEnabled": {
        "type": "boolean",
        "description": "Enable AI Security Gateway (default: true)"
      },
      "gatewayPort": {
        "type": "number",
        "description": "Port for the AI Security Gateway (default: 28900)"
      },
      "gatewayAutoStart": {
        "type": "boolean",
        "description": "Automatically start the gateway when plugin loads (default: true)"
      },
      "blockOnRisk": {
        "type": "boolean",
        "description": "Block tool calls when injection is detected (default: true)"
      },
      "apiKey": {
        "type": "string",
        "description": "API key (optional â€” auto-registered if missing)"
      },
      "timeoutMs": {
        "type": "number",
        "description": "Timeout for analysis in milliseconds (default: 60000)"
      },
      "logPath": {
        "type": "string",
        "description": "Path to directory for JSONL log files (default: ~/.openclaw/logs)"
      },
      "autoRegister": {
        "type": "boolean",
        "description": "Automatically register an API key if apiKey is missing (default: true)"
      },
      "apiBaseUrl": {
        "type": "string",
        "description": "OpenGuardrails API base URL (default: https://api.openguardrails.com)"
      }
    }
  },
  "uiHints": {
    "enabled": {
      "label": "Enable Guard",
      "help": "Enable or disable prompt injection detection"
    },
    "gatewayEnabled": {
      "label": "AI Security Gateway",
      "help": "Enable AI Security Gateway to protect sensitive data (bank cards, passwords, etc.) before sending to LLM."
    },
    "gatewayPort": {
      "label": "Gateway Port",
      "help": "Port for the AI Security Gateway",
      "advanced": true
    },
    "gatewayAutoStart": {
      "label": "Auto-start Gateway",
      "help": "Automatically start the gateway process when OpenClaw starts",
      "advanced": true
    },
    "blockOnRisk": {
      "label": "Block on Risk",
      "help": "Block tool calls when prompt injection is detected"
    },
    "apiKey": {
      "label": "API Key",
      "help": "Your API key. Leave blank for automatic registration on first use.",
      "advanced": true
    },
    "timeoutMs": {
      "label": "Timeout (ms)",
      "help": "Maximum time for analysis",
      "advanced": true
    },
    "logPath": {
      "label": "Log Directory",
      "help": "Custom path for the JSONL analysis log files",
      "advanced": true
    },
    "autoRegister": {
      "label": "Auto-register API Key",
      "help": "If enabled and apiKey is empty, OpenGuardrails will register a key on first use. Disable for strict no-network/managed deployments.",
      "advanced": true
    },
    "apiBaseUrl": {
      "label": "API Base URL",
      "help": "Override the OpenGuardrails API endpoint (e.g. staging or self-hosted).",
      "advanced": true
    }
  }
}
